(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{428:function(e,t,n){"use strict";n.r(t);var a=n(56),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"using-python-with-nubesgen"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-python-with-nubesgen"}},[e._v("#")]),e._v(" Using Python with NubesGen")]),e._v(" "),n("p",[e._v("This documentation is for running Python applications with NubesGen, and there is another option that might interest you:")]),e._v(" "),n("ul",[n("li",[e._v("As Python applications can be packaged with Docker, you can also run them as "),n("RouterLink",{attrs:{to:"/runtimes/docker/"}},[e._v("Docker applications with NubesGen")]),e._v(".")],1)]),e._v(" "),n("p",[e._v("NubesGen supports creating Azure App Service instances and Azure Functions instances, depending on the type of Python application that you wish to deploy.")]),e._v(" "),n("h2",{attrs:{id:"tutorial-running-a-python-application-with-nubesgen"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tutorial-running-a-python-application-with-nubesgen"}},[e._v("#")]),e._v(" Tutorial: running a Python application with NubesGen")]),e._v(" "),n("p",[n("strong",[e._v("Prerequisites:")])]),e._v(" "),n("p",[n("em",[e._v("Tip: You can go to "),n("a",{attrs:{href:"https://aka.ms/nubesgen-azure-shell",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://aka.ms/nubesgen-azure-shell"),n("OutboundLink")],1),e._v(" to have those prerequisites installed, and run the script from a Web browser.")])]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://fr.wikipedia.org/wiki/Bourne-Again_shell",target:"_blank",rel:"noopener noreferrer"}},[e._v("Bash"),n("OutboundLink")],1),e._v(", which is installed by default on most Linux distributions and on Mac OS X. If you're using Windows, one solution is to use "),n("a",{attrs:{href:"https://aka.ms/nubesgen-install-wsl",target:"_blank",rel:"noopener noreferrer"}},[e._v("WSL"),n("OutboundLink")],1),e._v(".")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://aka.ms/nubesgen-install-az-cli",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure CLI"),n("OutboundLink")],1),e._v(". To login, use "),n("code",[e._v("az login")]),e._v(".")]),e._v(" "),n("li",[e._v("(optional) "),n("a",{attrs:{href:"https://cli.github.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub CLI"),n("OutboundLink")],1),e._v(". To login, use "),n("code",[e._v("gh auth login")]),e._v(".")])]),e._v(" "),n("p",[n("strong",[e._v("Steps:")])]),e._v(" "),n("ol",[n("li",[e._v("Create a sample Python Web application using "),n("a",{attrs:{href:"https://flask.palletsprojects.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Flask"),n("OutboundLink")],1),e._v(".\nWe'll follow the beginning of the "),n("a",{attrs:{href:"https://flask.palletsprojects.com/quickstart/#a-minimal-application",target:"_blank",rel:"noopener noreferrer"}},[e._v('Flask "a Minimal Application" guide'),n("OutboundLink")],1),e._v(":\nCreate a new file called "),n("code",[e._v("app.py")]),e._v(" in the root of your project."),n("div",{staticClass:"language-python extra-class"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" flask "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" Flask\n\napp "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" Flask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("__name__"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[e._v("@app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("route")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("def")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("hello_world")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n "),n("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"<p>Hello, World!</p>"')]),e._v("\n")])])]),e._v("To manage the project's dependencies, create a file called "),n("code",[e._v("requirements.txt")]),e._v(" in the root of your project."),n("div",{staticClass:"language-text extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Flask==2.1.2\n")])])])]),e._v(" "),n("li",[e._v("Create a project on GitHub called "),n("code",[e._v("python-sample-app")]),e._v(", and push the generated project to that repository. Change "),n("code",[e._v("<your-github-account>")]),e._v(" by the name of your GitHub account:"),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" init\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"first commit"')]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" remote "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" origin https://github.com/"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("your-github-account"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("/python-sample-app.git\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" branch -M main\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" push -u origin main\n")])])])]),e._v(" "),n("li",[e._v("In the cloned project ("),n("code",[e._v("cd python-sample-app")]),e._v("), set up GitOps with NubesGen by running the NubesGen CLI ("),n("RouterLink",{attrs:{to:"/gitops/gitops-quick-start/"}},[e._v("more information here")]),e._v("):"),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[e._v(" ./nubesgen-cli-linux gitops\n")])])])],1),e._v(" "),n("li",[e._v("Use the command-line with NubesGen ("),n("RouterLink",{attrs:{to:"/reference/rest-api/"}},[e._v("more information here")]),e._v(") to generate a NubesGen configuration:"),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://nubesgen.com/demo.tgz?runtime=python&application=app_service.standard&gitops=true"')]),e._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" -xzvf -\n")])])])],1),e._v(" "),n("li",[e._v("Create a new branch called "),n("code",[e._v("env-dev")]),e._v(", and push your code:"),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" checkout -b env-dev\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("add")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v(".")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Configure GitOps with NubesGen'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" push --set-upstream origin env-dev\n")])])])]),e._v(" "),n("li",[e._v("Go to your GitHub project, and check that the GitHub Action is running.")]),e._v(" "),n("li",[e._v("You can go to the "),n("a",{attrs:{href:"https://aka.ms/nubesgen-portal",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Portal"),n("OutboundLink")],1),e._v(" to check the created resources.")]),e._v(" "),n("li",[e._v("The application should be deployed on your App Service instance. Its URL should be in the form "),n("code",[e._v("https://app-demo-XXXX-XXXX-XXXX-XXXX-dev-001.azurewebsites.net/")]),e._v(',\nand you can also find it in the GitHub Action workflow (Job: "display-information", step "Display Azure infrastructure information"), or in the Azure portal.\nAs it is a simple application, it should print by default '),n("code",[e._v("Hello, World!")]),e._v(".")]),e._v(" "),n("li",[e._v("Once you have finished, you should clean up your resources:")]),e._v(" "),n("li",[e._v("Delete the resource group that was created by NubesGen to host your resources, which is named "),n("code",[e._v("rg-demo-XXXX-XXXX-XXXX-XXXX-001")]),e._v(".")]),e._v(" "),n("li",[e._v("Delete the storage account used to store your Terraform state, in the "),n("code",[e._v("rg-terraform-001")]),e._v(" resource group.")])]),e._v(" "),n("h2",{attrs:{id:"which-azure-resources-are-created"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#which-azure-resources-are-created"}},[e._v("#")]),e._v(" Which Azure resources are created")]),e._v(" "),n("p",[e._v("If you deploy your Python application to an Azure App Service instance, NubesGen will generate:")]),e._v(" "),n("ul",[n("li",[e._v("An "),n("a",{attrs:{href:"https://aka.ms/nubesgen-app-service-plans",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service plan"),n("OutboundLink")],1),e._v(" to define the type of App Service instance you will use.")]),e._v(" "),n("li",[e._v("An "),n("a",{attrs:{href:"https://aka.ms/nubesgen-app-service",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service instance"),n("OutboundLink")],1),e._v(", configured to run Python code natively.")])]),e._v(" "),n("p",[e._v("If you deploy your Python application to an Azure Function, NubesGen will generate:")]),e._v(" "),n("ul",[n("li",[e._v("An "),n("a",{attrs:{href:"https://aka.ms/nubesgen-app-service-plans",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service plan"),n("OutboundLink")],1),e._v(" to define the type of Azure Functions instance you will use.")]),e._v(" "),n("li",[e._v("An "),n("a",{attrs:{href:"https://aka.ms/nubesgen-functions",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Functions instance"),n("OutboundLink")],1),e._v(", configured to run Python code natively.")]),e._v(" "),n("li",[e._v("An "),n("a",{attrs:{href:"https://aka.ms/nubesgen-storage",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Storage Account"),n("OutboundLink")],1),e._v(", to store your Python application.")])]),e._v(" "),n("h2",{attrs:{id:"configuration-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configuration-options"}},[e._v("#")]),e._v(" Configuration options")]),e._v(" "),n("p",[e._v("In the generated "),n("code",[e._v("terraform/modules/app-service/main.tf")]),e._v(" file, NubesGen will configure some variables\nfor your application.")]),e._v(" "),n("h3",{attrs:{id:"other-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#other-options"}},[e._v("#")]),e._v(" Other options")]),e._v(" "),n("p",[e._v("NubesGen will configure some environment variables for your application.")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("DATABASE_URL")]),e._v(": the URL to your database")]),e._v(" "),n("li",[n("code",[e._v("DATABASE_USERNAME")]),e._v(": the database user name")]),e._v(" "),n("li",[n("code",[e._v("DATABASE_PASSWORD")]),e._v(": the database password")]),e._v(" "),n("li",[n("code",[e._v("REDIS_HOST")]),e._v(": the Redis host name")]),e._v(" "),n("li",[n("code",[e._v("REDIS_PASSWORD")]),e._v(": the Redis password")]),e._v(" "),n("li",[n("code",[e._v("REDIS_PORT")]),e._v(": the Redis port (by default "),n("code",[e._v("6380")]),e._v(")")]),e._v(" "),n("li",[n("code",[e._v("AZURE_STORAGE_ACCOUNT_NAME")]),e._v(": the storage account name")]),e._v(" "),n("li",[n("code",[e._v("AZURE_STORAGE_ACCOUNT_KEY")]),e._v(": the storage account key")]),e._v(" "),n("li",[n("code",[e._v("AZURE_STORAGE_BLOB_ENDPOINT")]),e._v(": the blob storage endpoint")]),e._v(" "),n("li",[n("code",[e._v("MONGODB_DATABASE")]),e._v(": the MongoDB database name")]),e._v(" "),n("li",[n("code",[e._v("MONGODB_URI")]),e._v(": the MongoDB database URL")])])])}),[],!1,null,null,null);t.default=s.exports}}]);